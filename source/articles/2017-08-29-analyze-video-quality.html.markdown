---

title: トランスコード後のビデオの画質評価 PNSRとSSIM
date: 2017-08-29 22:00 JST
tags: SSIM, PNSR, ffmpeg

---

動画のトランスコード後に、もとの素材からどのくらい画質劣化が発生したのかを調べる方法について調べた。
画質の評価方法にはいくつか種類があるが、今回はPSNRとSSIMを利用し映像劣化やノイズがどの程度検出できるのかについて検証した。

検証の結果、SSIMやPSNRといった指標を活用することで、
トランスコード後のノイズ（ブロックノイズやモスキートノイズ等）の検出が可能かもしれないということがわかった。


## はじめに

ProResやHDxHDと言った中間コーデックは無圧縮の動画並みの品質を持っているが、そのまま配信するにはデータ量が大きすぎる。
動画をエンドユーザに配信するためには、コンテンツをMPEG2やH.264といった配信用のフォーマットに変換する必要がある。

MPEGやh264は編集には適さないが、高い映像品質を維持したままデータサイズを大幅に抑えることができるため、
テレビ放送やBD/DVD、及びVODなどの動画配信サービスで利用されている。 
これらのフォーマットでは、元の素材から人間にはわかりづらい領域のデータを削ったり、
前後のフレームからの差分情報だけを保持するなどしてデータ量削減を行っている。

データ量を抑えようとすればするほどより多くの情報を削るため、
動画のトランスコードの仕方によっては目に見えて映像劣化がわかってしまう。
これらの劣化は、ブロックノイズやモスキートノイズとなって映像に現れる。
動きの早いシーンではフレーム間予測がうまく働かずにデータ量が増えてしまうが、
映像に割り当てられるデータ量には上限があるため、こういったシーンではノイズがより多く発生する可能性がある。
また色の移り変わりの激しい箇所やシーンでも同様にノイズが発生する可能性がある。

今回はffmpeg及びPSNRとSSIMを使いトランスコード前の素材から、トランスコード後の映像がどの程度劣化したかを調べる方法を調査した。

## PNSRとSSIM
